{"version":3,"file":"shadow.js","names":["WUJIE_APP_ID","WUJIE_IFRAME_CLASS","WUJIE_SHADE_STYLE","CONTAINER_POSITION_DATA_FLAG","CONTAINER_OVERFLOW_DATA_FLAG","LOADING_DATA_FLAG","WUJIE_LOADING_STYLE","WUJIE_LOADING_SVG","getWujieById","rawAppendChild","rawElementAppendChild","rawElementRemoveChild","relativeElementTagAttrMap","getExternalStyleSheets","patchElementEffect","patchRenderEffect","getCssLoader","getPresetLoaders","getAbsolutePath","getContainer","getCurUrl","setAttrsToElement","cssSelectorMap","defineWujieWebComponent","customElements","window","get","WujieApp","_HTMLElement","_classCallCheck","_callSuper","arguments","_inherits","_createClass","key","value","connectedCallback","shadowRoot","attachShadow","mode","sandbox","getAttribute","iframe","contentWindow","disconnectedCallback","unmount","_wrapNativeSuper","HTMLElement","define","createWujieWebComponent","id","contentElement","document","createElement","setAttribute","classList","add","renderElementToContainer","element","selectorOrElement","container","contains","querySelector","concat","clearChild","call","initRenderIframeAndContainer","parent","degradeAttrs","length","undefined","createIframeContainer","contentDocument","open","write","close","processCssLoaderForTemplate","_x","_x2","_processCssLoaderForTemplate","apply","_asyncToGenerator","_regeneratorRuntime","mark","_callee","html","plugins","replace","proxyLocation","cssLoader","cssBeforeLoaders","cssAfterLoaders","curUrl","wrap","_callee$","_context","prev","next","Promise","all","fetch","lifecycles","loadError","map","_ref","src","contentPromise","then","content","contentList","forEach","_ref2","styleElement","appendChild","createTextNode","head","body","insertBefore","firstChild","_ref3","_ref4","abrupt","sent","stop","replaceHeadAndBody","headElement","bodyElement","cloneNode","removeChild","parentNode","replaceChild","renderTemplateToHtml","iframeWindow","template","__WUJIE","alive","execFlag","innerHTML","ElementIterator","createTreeWalker","NodeFilter","SHOW_ELEMENT","nextElement","currentNode","relativeAttr","tagName","url","baseURI","nextNode","renderTemplateToShadowRoot","_x3","_x4","_x5","_renderTemplateToShadowRoot","_callee2","processedHtml","shade","_callee2$","_context2","Object","defineProperty","enumerable","configurable","defaultStyle","_objectSpread","_defineProperty","style","join","renderTemplateToIframe","_x6","_x7","_x8","_renderTemplateToIframe","_callee3","renderDocument","_callee3$","_context3","documentElement","root","addLoading","el","loading","containerStyles","getComputedStyle","_unused","position","overflow","setProperty","includes","loadingContainer","removeLoading","positionFlag","overflowFlag","removeProperty","removeAttribute","getPatchStyleElements","rootStyleSheets","rootCssRules","fontCssRules","rootStyleReg","i","_rootStyleSheets$i$cs","_rootStyleSheets$i","cssRules","j","cssRuleText","cssText","test","push","match","type","CSSRule","FONT_FACE_RULE","rootStyleSheetElement","fontStyleSheetElement"],"sources":["../src/shadow.ts"],"sourcesContent":["import {\r\n  WUJIE_APP_ID,\r\n  WUJIE_IFRAME_CLASS,\r\n  WUJIE_SHADE_STYLE,\r\n  CONTAINER_POSITION_DATA_FLAG,\r\n  CONTAINER_OVERFLOW_DATA_FLAG,\r\n  LOADING_DATA_FLAG,\r\n  WUJIE_LOADING_STYLE,\r\n  WUJIE_LOADING_SVG,\r\n} from \"./constant\";\r\nimport {\r\n  getWujieById,\r\n  rawAppendChild,\r\n  rawElementAppendChild,\r\n  rawElementRemoveChild,\r\n  relativeElementTagAttrMap,\r\n} from \"./common\";\r\nimport { getExternalStyleSheets } from \"./entry\";\r\nimport Wujie from \"./sandbox\";\r\nimport { patchElementEffect } from \"./iframe\";\r\nimport { patchRenderEffect } from \"./effect\";\r\nimport { getCssLoader, getPresetLoaders } from \"./plugin\";\r\nimport { getAbsolutePath, getContainer, getCurUrl, setAttrsToElement } from \"./utils\";\r\n\r\nconst cssSelectorMap = {\r\n  \":root\": \":host\",\r\n};\r\n\r\ndeclare global {\r\n  interface ShadowRoot {\r\n    head: HTMLHeadElement;\r\n    body: HTMLBodyElement;\r\n  }\r\n}\r\n\r\n/**\r\n * 定义 wujie webComponent，将shadow包裹并获得dom装载和卸载的生命周期\r\n */\r\nexport function defineWujieWebComponent() {\r\n  const customElements = window.customElements;\r\n  if (customElements && !customElements?.get(\"wujie-app\")) {\r\n    class WujieApp extends HTMLElement {\r\n      connectedCallback(): void {\r\n        if (this.shadowRoot) return;\r\n        const shadowRoot = this.attachShadow({ mode: \"open\" });\r\n        const sandbox = getWujieById(this.getAttribute(WUJIE_APP_ID));\r\n        patchElementEffect(shadowRoot, sandbox.iframe.contentWindow);\r\n        sandbox.shadowRoot = shadowRoot;\r\n      }\r\n\r\n      disconnectedCallback(): void {\r\n        const sandbox = getWujieById(this.getAttribute(WUJIE_APP_ID));\r\n        sandbox?.unmount();\r\n      }\r\n    }\r\n    customElements?.define(\"wujie-app\", WujieApp);\r\n  }\r\n}\r\n\r\nexport function createWujieWebComponent(id: string): HTMLElement {\r\n  const contentElement = window.document.createElement(\"wujie-app\");\r\n  contentElement.setAttribute(WUJIE_APP_ID, id);\r\n  contentElement.classList.add(WUJIE_IFRAME_CLASS);\r\n  return contentElement;\r\n}\r\n\r\n/**\r\n * 将准备好的内容插入容器\r\n */\r\nexport function renderElementToContainer(\r\n  element: Element | ChildNode,\r\n  selectorOrElement: string | HTMLElement\r\n): HTMLElement {\r\n  const container = getContainer(selectorOrElement);\r\n  if (container && !container.contains(element)) {\r\n    // 有 loading 无需清理，已经清理过了\r\n    if (!container.querySelector(`div[${LOADING_DATA_FLAG}]`)) {\r\n      // 清除内容\r\n      clearChild(container);\r\n    }\r\n    // 插入元素\r\n    if (element) {\r\n      rawElementAppendChild.call(container, element);\r\n    }\r\n  }\r\n  return container;\r\n}\r\n\r\n/**\r\n * 将降级的iframe挂在到容器上并进行初始化\r\n */\r\nexport function initRenderIframeAndContainer(\r\n  id: string,\r\n  parent: string | HTMLElement,\r\n  degradeAttrs: { [key: string]: any } = {}\r\n): { iframe: HTMLIFrameElement; container: HTMLElement } {\r\n  const iframe = createIframeContainer(id, degradeAttrs);\r\n  const container = renderElementToContainer(iframe, parent);\r\n  const contentDocument = iframe.contentWindow.document;\r\n  contentDocument.open();\r\n  contentDocument.write(\"<!DOCTYPE html><html><head></head><body></body></html>\");\r\n  contentDocument.close();\r\n  return { iframe, container };\r\n}\r\n\r\n/**\r\n * 处理css-before-loader 以及 css-after-loader\r\n */\r\nasync function processCssLoaderForTemplate(sandbox: Wujie, html: HTMLHtmlElement): Promise<HTMLHtmlElement> {\r\n  const document = sandbox.iframe.contentDocument;\r\n  const { plugins, replace, proxyLocation } = sandbox;\r\n  const cssLoader = getCssLoader({ plugins, replace });\r\n  const cssBeforeLoaders = getPresetLoaders(\"cssBeforeLoaders\", plugins);\r\n  const cssAfterLoaders = getPresetLoaders(\"cssAfterLoaders\", plugins);\r\n  const curUrl = getCurUrl(proxyLocation);\r\n\r\n  return await Promise.all([\r\n    Promise.all(\r\n      getExternalStyleSheets(cssBeforeLoaders, sandbox.fetch, sandbox.lifecycles.loadError).map(\r\n        ({ src, contentPromise }) => contentPromise.then((content) => ({ src, content }))\r\n      )\r\n    ).then((contentList) => {\r\n      contentList.forEach(({ src, content }) => {\r\n        if (!content) return;\r\n        const styleElement = document.createElement(\"style\");\r\n        styleElement.setAttribute(\"type\", \"text/css\");\r\n        styleElement.appendChild(document.createTextNode(content ? cssLoader(content, src, curUrl) : content));\r\n        const head = html.querySelector(\"head\");\r\n        const body = html.querySelector(\"body\");\r\n        html.insertBefore(styleElement, head || body || html.firstChild);\r\n      });\r\n    }),\r\n    Promise.all(\r\n      getExternalStyleSheets(cssAfterLoaders, sandbox.fetch, sandbox.lifecycles.loadError).map(\r\n        ({ src, contentPromise }) => contentPromise.then((content) => ({ src, content }))\r\n      )\r\n    ).then((contentList) => {\r\n      contentList.forEach(({ src, content }) => {\r\n        if (!content) return;\r\n        const styleElement = document.createElement(\"style\");\r\n        styleElement.setAttribute(\"type\", \"text/css\");\r\n        styleElement.appendChild(document.createTextNode(content ? cssLoader(content, src, curUrl) : content));\r\n        html.appendChild(styleElement);\r\n      });\r\n    }),\r\n  ]).then(\r\n    () => html,\r\n    () => html\r\n  );\r\n}\r\n\r\n// 替换html的head和body\r\nfunction replaceHeadAndBody(html: HTMLHtmlElement, head: HTMLHeadElement, body: HTMLBodyElement): HTMLHtmlElement {\r\n  const headElement = html.querySelector(\"head\");\r\n  const bodyElement = html.querySelector(\"body\");\r\n  if (headElement) {\r\n    while (headElement.firstChild) {\r\n      rawAppendChild.call(head, headElement.firstChild.cloneNode(true));\r\n      headElement.removeChild(headElement.firstChild);\r\n    }\r\n    headElement.parentNode.replaceChild(head, headElement);\r\n  }\r\n  if (bodyElement) {\r\n    while (bodyElement.firstChild) {\r\n      rawAppendChild.call(body, bodyElement.firstChild.cloneNode(true));\r\n      bodyElement.removeChild(bodyElement.firstChild);\r\n    }\r\n    bodyElement.parentNode.replaceChild(body, bodyElement);\r\n  }\r\n  return html;\r\n}\r\n\r\n/**\r\n * 将template渲染成html元素\r\n */\r\nfunction renderTemplateToHtml(iframeWindow: Window, template: string): HTMLHtmlElement {\r\n  const sandbox = iframeWindow.__WUJIE;\r\n  const { head, body, alive, execFlag } = sandbox;\r\n  const document = iframeWindow.document;\r\n  let html = document.createElement(\"html\");\r\n  html.innerHTML = template;\r\n  // 组件多次渲染，head和body必须一直使用同一个来应对被缓存的场景\r\n  if (!alive && execFlag) {\r\n    html = replaceHeadAndBody(html, head, body);\r\n  } else {\r\n    sandbox.head = html.querySelector(\"head\");\r\n    sandbox.body = html.querySelector(\"body\");\r\n  }\r\n  const ElementIterator = document.createTreeWalker(html, NodeFilter.SHOW_ELEMENT, null, false);\r\n  let nextElement = ElementIterator.currentNode as HTMLElement;\r\n  while (nextElement) {\r\n    patchElementEffect(nextElement, iframeWindow);\r\n    const relativeAttr = relativeElementTagAttrMap[nextElement.tagName];\r\n    const url = nextElement[relativeAttr];\r\n    if (relativeAttr) nextElement.setAttribute(relativeAttr, getAbsolutePath(url, nextElement.baseURI || \"\"));\r\n    nextElement = ElementIterator.nextNode() as HTMLElement;\r\n  }\r\n  if (!html.querySelector(\"head\")) {\r\n    const head = document.createElement(\"head\");\r\n    html.appendChild(head);\r\n  }\r\n  if (!html.querySelector(\"body\")) {\r\n    const body = document.createElement(\"body\");\r\n    html.appendChild(body);\r\n  }\r\n  return html;\r\n}\r\n\r\n/**\r\n * 将template渲染到shadowRoot\r\n */\r\nexport async function renderTemplateToShadowRoot(\r\n  shadowRoot: ShadowRoot,\r\n  iframeWindow: Window,\r\n  template: string\r\n): Promise<void> {\r\n  const html = renderTemplateToHtml(iframeWindow, template);\r\n  // 处理 css-before-loader 和 css-after-loader\r\n  const processedHtml = await processCssLoaderForTemplate(iframeWindow.__WUJIE, html);\r\n  // change ownerDocument\r\n  shadowRoot.appendChild(processedHtml);\r\n  const shade = document.createElement(\"div\");\r\n  shade.setAttribute(\"style\", WUJIE_SHADE_STYLE);\r\n  processedHtml.insertBefore(shade, processedHtml.firstChild);\r\n  shadowRoot.head = shadowRoot.querySelector(\"head\");\r\n  shadowRoot.body = shadowRoot.querySelector(\"body\");\r\n\r\n  // 修复 html parentNode\r\n  Object.defineProperty(shadowRoot.firstChild, \"parentNode\", {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: () => iframeWindow.document,\r\n  });\r\n\r\n  patchRenderEffect(shadowRoot, iframeWindow.__WUJIE.id, false);\r\n}\r\n\r\nexport function createIframeContainer(id: string, degradeAttrs: { [key: string]: any } = {}): HTMLIFrameElement {\r\n  const iframe = document.createElement(\"iframe\");\r\n  const defaultStyle = \"height:100%;width:100%\";\r\n  setAttrsToElement(iframe, {\r\n    ...degradeAttrs,\r\n    style: [defaultStyle, degradeAttrs.style].join(\";\"),\r\n    [WUJIE_APP_ID]: id,\r\n  });\r\n  return iframe;\r\n}\r\n\r\n/**\r\n * 将template渲染到iframe\r\n */\r\nexport async function renderTemplateToIframe(\r\n  renderDocument: Document,\r\n  iframeWindow: Window,\r\n  template: string\r\n): Promise<void> {\r\n  // 插入template\r\n  const html = renderTemplateToHtml(iframeWindow, template);\r\n  // 处理 css-before-loader 和 css-after-loader\r\n  const processedHtml = await processCssLoaderForTemplate(iframeWindow.__WUJIE, html);\r\n  renderDocument.replaceChild(processedHtml, renderDocument.documentElement);\r\n\r\n  // 修复 html parentNode\r\n  Object.defineProperty(renderDocument.documentElement, \"parentNode\", {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: () => iframeWindow.document,\r\n  });\r\n\r\n  patchRenderEffect(renderDocument, iframeWindow.__WUJIE.id, true);\r\n}\r\n\r\n/**\r\n * 清除Element所有节点\r\n */\r\nexport function clearChild(root: ShadowRoot | Node): void {\r\n  // 清除内容\r\n  while (root?.firstChild) {\r\n    rawElementRemoveChild.call(root, root.firstChild);\r\n  }\r\n}\r\n\r\n/**\r\n * 给容器添加loading\r\n */\r\nexport function addLoading(el: string | HTMLElement, loading: HTMLElement): void {\r\n  const container = getContainer(el);\r\n  clearChild(container);\r\n  // 给容器设置一些样式，防止 loading 抖动\r\n  let containerStyles = null;\r\n  try {\r\n    containerStyles = window.getComputedStyle(container);\r\n  } catch {\r\n    return;\r\n  }\r\n  if (containerStyles.position === \"static\") {\r\n    container.setAttribute(CONTAINER_POSITION_DATA_FLAG, containerStyles.position);\r\n    container.setAttribute(\r\n      CONTAINER_OVERFLOW_DATA_FLAG,\r\n      containerStyles.overflow === \"visible\" ? \"\" : containerStyles.overflow\r\n    );\r\n    container.style.setProperty(\"position\", \"relative\");\r\n    container.style.setProperty(\"overflow\", \"hidden\");\r\n  } else if ([\"relative\", \"sticky\"].includes(containerStyles.position)) {\r\n    container.setAttribute(\r\n      CONTAINER_OVERFLOW_DATA_FLAG,\r\n      containerStyles.overflow === \"visible\" ? \"\" : containerStyles.overflow\r\n    );\r\n    container.style.setProperty(\"overflow\", \"hidden\");\r\n  }\r\n  const loadingContainer = document.createElement(\"div\");\r\n  loadingContainer.setAttribute(LOADING_DATA_FLAG, \"\");\r\n  loadingContainer.setAttribute(\"style\", WUJIE_LOADING_STYLE);\r\n  if (loading) loadingContainer.appendChild(loading);\r\n  else loadingContainer.innerHTML = WUJIE_LOADING_SVG;\r\n  container.appendChild(loadingContainer);\r\n}\r\n/**\r\n * 移除loading\r\n */\r\nexport function removeLoading(el: HTMLElement): void {\r\n  // 去除容器设置的样式\r\n  const positionFlag = el.getAttribute(CONTAINER_POSITION_DATA_FLAG);\r\n  const overflowFlag = el.getAttribute(CONTAINER_OVERFLOW_DATA_FLAG);\r\n  if (positionFlag) el.style.removeProperty(\"position\");\r\n  if (overflowFlag !== null) {\r\n    overflowFlag ? el.style.setProperty(\"overflow\", overflowFlag) : el.style.removeProperty(\"overflow\");\r\n  }\r\n  el.removeAttribute(CONTAINER_POSITION_DATA_FLAG);\r\n  el.removeAttribute(CONTAINER_OVERFLOW_DATA_FLAG);\r\n  const loadingContainer = el.querySelector(`div[${LOADING_DATA_FLAG}]`);\r\n  loadingContainer && el.removeChild(loadingContainer);\r\n}\r\n/**\r\n * 获取修复好的样式元素\r\n * 主要是针对对root样式和font-face样式\r\n */\r\nexport function getPatchStyleElements(rootStyleSheets: Array<CSSStyleSheet>): Array<HTMLStyleElement | null> {\r\n  const rootCssRules = [];\r\n  const fontCssRules = [];\r\n  const rootStyleReg = /:root/g;\r\n\r\n  // 找出root的cssRules\r\n  for (let i = 0; i < rootStyleSheets.length; i++) {\r\n    const cssRules = rootStyleSheets[i]?.cssRules ?? [];\r\n    for (let j = 0; j < cssRules.length; j++) {\r\n      const cssRuleText = cssRules[j].cssText;\r\n      // 如果是root的cssRule\r\n      if (rootStyleReg.test(cssRuleText)) {\r\n        rootCssRules.push(cssRuleText.replace(rootStyleReg, (match) => cssSelectorMap[match]));\r\n      }\r\n      // 如果是font-face的cssRule\r\n      if (cssRules[j].type === CSSRule.FONT_FACE_RULE) {\r\n        fontCssRules.push(cssRuleText);\r\n      }\r\n    }\r\n  }\r\n\r\n  let rootStyleSheetElement = null;\r\n  let fontStyleSheetElement = null;\r\n\r\n  // 复制到host上\r\n  if (rootCssRules.length) {\r\n    rootStyleSheetElement = window.document.createElement(\"style\");\r\n    rootStyleSheetElement.innerHTML = rootCssRules.join(\"\");\r\n  }\r\n\r\n  if (fontCssRules.length) {\r\n    fontStyleSheetElement = window.document.createElement(\"style\");\r\n    fontStyleSheetElement.innerHTML = fontCssRules.join(\"\");\r\n  }\r\n\r\n  return [rootStyleSheetElement, fontStyleSheetElement];\r\n}\r\n"],"mappings":"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","ignoreList":[]}